# frozen_string_literal: true

module Deeprails
  module Models
    # @see Deeprails::Resources::Evaluate#create
    class EvaluateCreateParams < Deeprails::Internal::Type::BaseModel
      extend Deeprails::Internal::Type::RequestParameters::Converter
      include Deeprails::Internal::Type::RequestParameters

      # @!attribute model_input
      #   A dictionary of inputs sent to the LLM to generate output. This must contain a
      #   `user_prompt` field and an optional `context` field. Additional properties are
      #   allowed.
      #
      #   @return [Deeprails::Models::EvaluateCreateParams::ModelInput]
      required :model_input, -> { Deeprails::EvaluateCreateParams::ModelInput }

      # @!attribute model_output
      #   Output generated by the LLM to be evaluated.
      #
      #   @return [String]
      required :model_output, String

      # @!attribute run_mode
      #   Run mode for the evaluation. The run mode allows the user to optimize for speed,
      #   accuracy, and cost by determining which models are used to evaluate the event.
      #   Available run modes include `precision_plus`, `precision`, `smart`, and
      #   `economy`. Defaults to `smart`.
      #
      #   @return [Symbol, Deeprails::Models::EvaluateCreateParams::RunMode]
      required :run_mode, enum: -> { Deeprails::EvaluateCreateParams::RunMode }

      # @!attribute guardrail_metrics
      #   An array of guardrail metrics that the model input and output pair will be
      #   evaluated on. For non-enterprise users, these will be limited to the allowed
      #   guardrail metrics.
      #
      #   @return [Array<Symbol, Deeprails::Models::EvaluateCreateParams::GuardrailMetric>, nil]
      optional :guardrail_metrics,
               -> { Deeprails::Internal::Type::ArrayOf[enum: Deeprails::EvaluateCreateParams::GuardrailMetric] }

      # @!attribute model_used
      #   Model ID used to generate the output, like `gpt-4o` or `o3`.
      #
      #   @return [String, nil]
      optional :model_used, String

      # @!attribute nametag
      #   An optional, user-defined tag for the evaluation.
      #
      #   @return [String, nil]
      optional :nametag, String

      # @!method initialize(model_input:, model_output:, run_mode:, guardrail_metrics: nil, model_used: nil, nametag: nil, request_options: {})
      #   Some parameter documentations has been truncated, see
      #   {Deeprails::Models::EvaluateCreateParams} for more details.
      #
      #   @param model_input [Deeprails::Models::EvaluateCreateParams::ModelInput] A dictionary of inputs sent to the LLM to generate output. This must contain a
      #
      #   @param model_output [String] Output generated by the LLM to be evaluated.
      #
      #   @param run_mode [Symbol, Deeprails::Models::EvaluateCreateParams::RunMode] Run mode for the evaluation. The run mode allows the user to optimize for speed
      #
      #   @param guardrail_metrics [Array<Symbol, Deeprails::Models::EvaluateCreateParams::GuardrailMetric>] An array of guardrail metrics that the model input and output pair will be evalu
      #
      #   @param model_used [String] Model ID used to generate the output, like `gpt-4o` or `o3`.
      #
      #   @param nametag [String] An optional, user-defined tag for the evaluation.
      #
      #   @param request_options [Deeprails::RequestOptions, Hash{Symbol=>Object}]

      class ModelInput < Deeprails::Internal::Type::BaseModel
        # @!attribute user_prompt
        #
        #   @return [String]
        required :user_prompt, String

        # @!attribute context
        #
        #   @return [String, nil]
        optional :context, String

        # @!method initialize(user_prompt:, context: nil)
        #   A dictionary of inputs sent to the LLM to generate output. This must contain a
        #   `user_prompt` field and an optional `context` field. Additional properties are
        #   allowed.
        #
        #   @param user_prompt [String]
        #   @param context [String]
      end

      # Run mode for the evaluation. The run mode allows the user to optimize for speed,
      # accuracy, and cost by determining which models are used to evaluate the event.
      # Available run modes include `precision_plus`, `precision`, `smart`, and
      # `economy`. Defaults to `smart`.
      module RunMode
        extend Deeprails::Internal::Type::Enum

        PRECISION_PLUS = :precision_plus
        PRECISION = :precision
        SMART = :smart
        ECONOMY = :economy

        # @!method self.values
        #   @return [Array<Symbol>]
      end

      module GuardrailMetric
        extend Deeprails::Internal::Type::Enum

        CORRECTNESS = :correctness
        COMPLETENESS = :completeness
        INSTRUCTION_ADHERENCE = :instruction_adherence
        CONTEXT_ADHERENCE = :context_adherence
        GROUND_TRUTH_ADHERENCE = :ground_truth_adherence
        COMPREHENSIVE_SAFETY = :comprehensive_safety

        # @!method self.values
        #   @return [Array<Symbol>]
      end
    end
  end
end
